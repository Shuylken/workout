package com.example.apple;

//获取传递的参数
    Intent it = getIntent();
    String u = it.getStringExtra("url");
    if(!TextUtils.isEmpty(u)){
        url = u;
    }
     
    webView = (WebView) this.findViewById(R.id.webView);
    tv_title = (TextView)this.findViewById(R.id.nav_titile_textview);
    btn_left = (Button) this.findViewById(R.id.nav_left_btn);
    btn_right =  (Button) this.findViewById(R.id.nav_right_btn);
     
    btn_left.setVisibility(View.VISIBLE);
    btn_right.setVisibility(View.VISIBLE);
    btn_left.setText("返回");
    btn_right.setText("刷新");
     
    //返回事件
    btn_left.setOnClickListener(new OnClickListener()
    {
         
        @Override
        public void onClick(View v)
        {
             finish();
        }
    });
     
    //刷新事件
    btn_right.setOnClickListener(new OnClickListener()
    {  
        @Override
        public void onClick(View v)
        {
              mPgrogressDialog.show();
               webView.loadUrl(url);
        }
    });
     
    // 显示网页加载中的小菊华花
        mPgrogressDialog =  new ProgressDialog(this);
        mPgrogressDialog.setTitle("");
        mPgrogressDialog.setMessage("正在加载网页...");
        mPgrogressDialog.show();
     
        webView.getSettings().setDefaultTextEncodingName("gbk");
         
        //在线程里启动网页加载
         new Thread(new Runnable()
            {
                @Override
                public void run()
                {
                     webView.loadUrl(url);
                     
                }
            }).start();

         webView.getSettings().setJavaScriptEnabled(true);
          
         webView.setWebChromeClient(new WebChromeClient(){
            @Override
            public void onReceivedTitle(WebView view, String title)
            {
                // TODO Auto-generated method stub
                super.onReceivedTitle(view, title);
                final String tmpTitle = title;
                runOnUiThread(new Runnable()
                {
                    @Override
                    public void run()
                    {
                        tv_title.setText(tmpTitle);
                    }
                });
            }
         });
          
     webView.setWebViewClient(new WebViewClient() 
        {    
            public boolean shouldOverrideUrlLoading(WebView view, String url)  
            {    
                view.loadUrl(url);    
                return true;    
            }   
            @Override
            public void onPageFinished(WebView view, String url)  
            { 
                 
                super.onPageFinished(view, url); 
                 
                runOnUiThread(new Runnable()
                {
                     
                    @Override
                    public void run()
                    {
                          mPgrogressDialog.dismiss();
                    }
                });
                
            } 
            @Override
            public void onPageStarted(WebView view, String url, Bitmap favicon)  
            { 
                super.onPageStarted(view, url, favicon); 
            } 
        });
}
}